# ============================================
# サンプル: 完全なMob定義
# ============================================
# MobManager + SkillExecutorで動作する完全な例

# 基本的なカスタムゾンビ
FireZombie:
  Type: ZOMBIE
  Display: '&c炎のゾンビ'
  Health: 150
  Damage: 12

  # AI設定
  AI:
    MovementSpeed: 0.3
    FollowRange: 24
    KnockbackResistance: 0.3
    HasAI: true
    HasGravity: true

  # 外観設定
  Appearance:
    CustomNameVisible: true
    Glowing: false
    Invisible: false

  # スキル設定
  Skills:
    # スポーン時
    OnSpawn:
      - name: SpawnEffect
        targeter:
          type: Self
        meta:
          sync: false
        skills:
          - skill: SpawnParticles
            effects:
              - type: Particle
                particle: FLAME
                count: 50
                offsetX: 1.0
                offsetY: 1.0
                offsetZ: 1.0

              - type: Sound
                sound: ENTITY_BLAZE_AMBIENT
                volume: 1.0
                pitch: 0.8

    # タイマー（定期実行）
    OnTimer:
      # ファイアボール攻撃
      - name: FireballAttack
        interval: 100  # 5秒ごと

        targeter:
          type: NearestPlayer
          range: 30
          condition: 'target.gameMode == "SURVIVAL"'

        condition: 'target.distance >= 5 && target.distance <= 25'

        meta:
          sync: false
          executeDelay: 0ms
          effectDelay: 0ms
          cancelOnDeath: true

        skills:
          # チャージエフェクト
          - skill: ChargeEffect
            meta:
              sync: false
              executeDelay: 0ms
            effects:
              - type: Particle
                particle: FLAME
                count: 20
              - type: Sound
                sound: ENTITY_BLAZE_SHOOT
                pitch: 1.5

          # ファイアボール発射
          - skill: FireballSkill
            meta:
              sync: true
              executeDelay: 500ms
            effects:
              - type: Damage
                amount: 15
              - type: Ignite
                duration: 5s
              - type: Particle
                particle: FLAME
                count: 30

          # 爆発音
          - skill: ExplosionSound
            meta:
              sync: false
              executeDelay: 1s
            effects:
              - type: Sound
                sound: ENTITY_GENERIC_EXPLODE
                volume: 0.8

      # 範囲炎上
      - name: AreaIgnite
        interval: 200  # 10秒ごと

        targeter:
          type: RadiusPlayers
          range: 8

        condition: 'math.random() < 0.5'  # 50%の確率

        meta:
          sync: true

        skills:
          - skill: IgniteArea
            effects:
              - type: Particle
                particle: LAVA
                count: 100
                offsetX: 3.0
                offsetY: 1.0
                offsetZ: 3.0

              - type: Ignite
                duration: 8s

              - type: Message
                message: '&c&l炎の領域！'

    # ダメージ受けた時
    OnDamaged:
      - name: CounterFire
        targeter:
          type: Attacker

        condition: 'damage.amount > 5'

        meta:
          sync: true

        skills:
          - skill: FireCounter
            effects:
              - type: Damage
                amount: 5
              - type: Ignite
                duration: 3s
              - type: Particle
                particle: FLAME
                count: 15

      # HP低下時の回復
      - name: EmergencyHeal
        targeter:
          type: Self

        condition: 'entity.health < entity.maxHealth * 0.3'

        meta:
          sync: true

        skills:
          - skill: HealSelf
            effects:
              - type: Heal
                amount: 50
              - type: Particle
                particle: HEART
                count: 20
              - type: Sound
                sound: ENTITY_PLAYER_LEVELUP

    # 死亡時
    OnDeath:
      - name: DeathExplosion
        targeter:
          type: RadiusEntities
          range: 10

        meta:
          sync: true

        skills:
          - skill: FinalExplosion
            effects:
              - type: Damage
                amount: 20
              - type: Particle
                particle: EXPLOSION_HUGE
                count: 50
              - type: Sound
                sound: ENTITY_GENERIC_EXPLODE
                volume: 2.0

  # ドロップ設定
  Drops:
    - item: BLAZE_ROD
      amount: 1-3
      chance: 0.5
      condition: 'attacker.type == "PLAYER"'

    - item: FIRE_CHARGE
      amount: 2-5
      chance: 0.8
      condition: 'attacker.type == "PLAYER"'

    - item: DIAMOND
      amount: 1
      chance: 0.1
      condition: 'attacker.type == "PLAYER" && world.difficulty == "HARD"'

---

# 氷のスケルトン
IceSkeleton:
  Type: SKELETON
  Display: '&b氷のスケルトン'
  Health: 120
  Damage: 10

  AI:
    MovementSpeed: 0.28
    FollowRange: 32
    KnockbackResistance: 0.2

  Appearance:
    CustomNameVisible: true
    Glowing: true

  Skills:
    OnTimer:
      # 氷の矢
      - name: IceArrow
        interval: 60  # 3秒ごと

        targeter:
          type: LineOfSight
          maxDistance: 40

        condition: 'target.distance >= 8'

        skills:
          - skill: FrostArrow
            meta:
              sync: true
            effects:
              - type: Damage
                amount: 12
              - type: PotionEffect
                effectType: SLOW
                duration: 5s
                amplifier: 2
              - type: Particle
                particle: SNOWFLAKE
                count: 30

      # 氷結オーラ
      - name: FrostAura
        interval: 100

        targeter:
          type: RadiusPlayers
          range: 5

        skills:
          - skill: SlowAura
            meta:
              sync: true
            effects:
              - type: PotionEffect
                effectType: SLOW
                duration: 3s
                amplifier: 1
              - type: Particle
                particle: SNOWFLAKE
                count: 50
                offsetX: 2.0
                offsetY: 2.0
                offsetZ: 2.0

    OnDamaged:
      # 氷の盾
      - name: IceShield
        targeter:
          type: Self

        condition: 'entity.health < entity.maxHealth * 0.5'

        meta:
          sync: true

        skills:
          - skill: FrostShield
            effects:
              - type: PotionEffect
                effectType: DAMAGE_RESISTANCE
                duration: 10s
                amplifier: 1
              - type: Particle
                particle: SNOWFLAKE
                count: 100

---

# ボスモブ例
DragonBoss:
  Type: ENDER_DRAGON
  Display: '&5&l闇の竜'
  Health: 1000
  Damage: 50

  AI:
    MovementSpeed: 0.4
    FollowRange: 64
    KnockbackResistance: 1.0

  Appearance:
    CustomNameVisible: true
    Glowing: true

  Skills:
    OnSpawn:
      - name: BossIntro
        targeter:
          type: RadiusPlayers
          range: 100

        skills:
          - skill: Announcement
            meta:
              sync: true
            effects:
              - type: Message
                message: '&5&l=== 闇の竜が現れた！ ==='
              - type: Sound
                sound: ENTITY_ENDER_DRAGON_GROWL
                volume: 3.0
              - type: Particle
                particle: DRAGON_BREATH
                count: 200

    OnTimer:
      # フェーズ1: 通常攻撃
      - name: NormalPhase
        interval: 100

        targeter:
          type: RandomTarget
          count: 1

        condition: 'entity.health > entity.maxHealth * 0.5'

        skills:
          - skill: DragonBreath
            meta:
              sync: true
            effects:
              - type: Damage
                amount: 30
              - type: PotionEffect
                effectType: WITHER
                duration: 5s
                amplifier: 1

      # フェーズ2: 強化攻撃
      - name: EnragedPhase
        interval: 80

        targeter:
          type: RadiusPlayers
          range: 30

        condition: 'entity.health <= entity.maxHealth * 0.5'

        skills:
          - skill: MassiveBreath
            meta:
              sync: true
            effects:
              - type: Damage
                amount: 50
              - type: PotionEffect
                effectType: WITHER
                duration: 10s
                amplifier: 2
              - type: Knockback
                strength: 3.0

    OnDamaged:
      # 反撃
      - name: Retaliation
        targeter:
          type: Attacker

        condition: 'damage.amount > 20'

        meta:
          sync: true

        skills:
          - skill: DragonRoar
            effects:
              - type: Damage
                amount: 40
              - type: Sound
                sound: ENTITY_ENDER_DRAGON_GROWL
                volume: 2.0

    OnDeath:
      - name: BossDefeat
        targeter:
          type: RadiusPlayers
          range: 100

        meta:
          sync: true

        skills:
          - skill: VictoryReward
            effects:
              - type: Message
                message: '&a&l=== 闇の竜を倒した！ ==='
              - type: Command
                command: 'give @s nether_star 1'
                asOp: true
              - type: Particle
                particle: FIREWORKS_SPARK
                count: 500
              - type: Sound
                sound: UI_TOAST_CHALLENGE_COMPLETE
                volume: 3.0